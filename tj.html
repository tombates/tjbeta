<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ThoughtJot</title>
<link href="css/tj.css" rel="stylesheet" type="text/css" />
<link href="css/dropmenu.css" rel="stylesheet" type="text/css" />
<script src="http://nimbusbase.com/static/nimbus.min.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<script src="./js/jquery-1.11.0.min.js"></script>
  <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css">
<script src="./js/nb.js"></script>
<script src="./js/tjdb.js"></script>
<!-- thanks to http://adamwhitcroft.com/batch/ for icon images -->
  <script>
  $(function() {
    $( "#dialog" ).dialog({
      autoOpen: false,
      show: {
        effect: "blind",
        duration: 1000
      },
      hide: {
        effect: "explode",
        duration: 1000
      }
    });
 
    $( "#helpOpen" ).click(function() {
      console.log("in helpOpen click handler");
      $( "#dialog" ).dialog( "option", "width", 800 );
      $( "#dialog" ).dialog( "open" );
    });
  });
  </script>
</head>

<!--body onload="init();" redundant and bad as we set an eventlistener for DOMContentLoaded and call init from it in the js-->
<body>
<!--a id="connectDropbox" onClick="Nimbus.Auth.authorize('Dropbox');">Connect to Dropbox - link initial state</a-->

<!--script>
    var linkDropbox;
	var Tasks;  // a model (table)
	var ja, jb;
    var auth = false;
    var sync_string = "eyJHRHJpdmUiOnsia2V5IjoiIiwic2NvcGUiOiIiLCJhcHBfbmFtZSI6IiJ9LCJEcm9wYm94Ijp7ImtleSI6Im5sc3pqNXhyaGxiMWs1cCIsInNlY3JldCI6ImZvOGEyNDRzZ2RmdGpiZiIsImFwcF9uYW1lIjoidGpiZXRhIn19"; 
	var sync_object = { 
		"Dropbox": { 
		  "key": "nlszj5xrhlb1k5p", 
		  "secret": "fo8a244sgdftjbf", 
		  "app_name": "tjbeta" 
		} 
	};
    Nimbus.Auth.setup(sync_object);
    //Nimbus.Auth.setup(sync_string);
	auth = Nimbus.Auth.authorized();
    linkDropbox = document.getElementById("connectDropbox");
	if(auth) { // change link text to connected
		linkDropbox.innerHTML = "Connected to Dropbox";
	} else {
		linkDropbox.innerHTML = "Connect to Dropbox";
	}

    Tasks = Nimbus.Model.setup("Tasks", ["descrip", "done", "id", "jot", "timestamp"]);
	ja = Tasks.create({"descrip":"New task", "done":false, "jot":"I have a thought."});
	jb = Tasks.create({"descrip":"A Query", "done":false, "jot":"I have a question.", "time":"now" });
	//instance = Tasks.findAllByAttribute("done", false);
	//instance.done = false;
    //instance.save();
	
	// i don't understand: merely creating the tasks instances writes them over to dropbox, the saves are not needed, also meaning
	// i can't test if i can save a whole model (table?) at once instead of just one instance (row) at a time. if not isn't that crazy
	// inefficient. i want a way to send the whole table over as a text file in one go - a save whole model
	// and how to get a timestamp,
	// some keys seem special, like "id" but is there a list of these in the docs? can't find
	// once authorized always authorized? seems weird. when i reload i'm still authorized apparently, i would
	// think when the connection ends you'd need some reauth but maybe this is user convencience but is it a good/secure idea?
	
	
	
	//ja.save();
	//jb.save();
	//Tasks.save();
	Tasks.destroyAll();
</script-->
<div id="container">
<header>
  <input type="button" id="cloudButton" onClick="nbx.userConnectRequest('Dropbox'); return false;" value=""
         title="You are not connected to cloud storage.&#10;Click to connect."/>
  <h1 class="thetitle">Thought Jot</h1>
  <div class="drop-menu">
    <!--span class="plus">&#9674;</span-->
        <ul class="sub-menu">
            <li ><a class="topic" onClick="preferencesScreen(); return false; "href = "prefs.html">&nbsp;&nbsp;&#9674;&nbsp;&nbsp;Preferences</a></li>
            <li ><a id="helpOpen" class="topic">&nbsp;&nbsp;&#9674;&nbsp;&nbsp;About</a></li>
         </ul>
  </div>
</header>

<!--img src="images/me-photo-cropped.png" width="100px" height="100px"-->

<form type="post" onSubmit="addJot(); return false;">
  <!--input type"text" id="todo" placeholder="What'cha got to do?" style="width:200px;" /-->
  <div class="jottextarea">
      <textarea class="jot" id="jot_composer" placeholder="Type a New Jot"></textarea>
      <div id="rightcontrols">
        <div id="rightcontrols_header"><span id="rctls_hdr_text">Tag&nbsp;Selector<span id="space">&nbsp;</span>Filter&nbsp;Options</span>
        </div>
        <div id="filterby_div">
            <input type="checkbox" onClick="toggleDateFilter(); return true;" id="filter_by_date" value="filter"/>By Date Range<br>
            <div id="filter_date_div" class="display_none">
              <!--input type="button" id="startdate_btn" value="" title="Choose start date"-->
              <input type="text" id="startdate" onClick="raiseCalendar(this.id); return false;" placeholder="start date" maxlength="12" title="Click for a calendar, or enter manually as mm/dd/yyyy." /><br>
              <!--input type="button" id="enddate_btn" value="" title="Choose end date"-->
              <input type="text" id="enddate" onClick="raiseCalendar(this.id); return false;" placeholder="end date" maxlength="12" title="Click for a calendar, or enter manually as mm/dd/yyyy" /><br>
            </div>
            <input type="checkbox" onClick="toggleTagFilter(); return true;" id="filter_by_tags" value="filter"/>By Tags<br>
            <div id="filter_tag_div" class="display_none">
              <input type="radio" name="tagfilter" id="filter_by_tags_or" value="filter" title="Use the Tag Selector to choose the filter tags."/>
              Any Selected Tag<br>
              <input type="radio" name="tagfilter" id="filter_by_tags_and" value="filter" title="Use the Tag Selector to choose the filter tags."/>
              All Selected Tags<br>
            </div>
        </div>
        <div id="tagselector_div"><select multiple id="tagselector">
                                                  <!--option value="tagA">tagA</option>
                                                  <option value="tagB">tagB</option>
                                                  <option value="tagC">tagC</option>
                                                  <option value="tagD">tagD</option>
                                                  <option value="tagE">tagE</option-->
                                               </select>
                        <!--input type="button" onClick="stageTags(); return false;" id="stagetags_btn" value="Stage tags" title="Move selected tags to the new jot Tags: field" /-->
        </div>
        <div id="filterbtn_div"><input type="button" id="applyfilters_btn" onClick="applyFilters()" value="Filter"/></div>
                                <input type="button" onClick="stageTags(); return false;" id="stagetags_btn" value="Stage tags" title="Move selected tags to the new jot Tags: field" />

      </div>
  </div>
  <div class="jotaddbtn"><input type="submit" class="addjot_img" value="" title="Add this jot" />&nbsp;&nbsp;Title:
                         <input type="text" id="add_titleinput" placeholder="untitled" maxlength="200"/>&nbsp;&nbsp;Tags:
                         <input type="text" id="add_tagsinput" placeholder="none" maxlength="200" title="Separate tags with commas"/>
                         <input type="button" onClick="mergeStagedTags(); return false;" class="mergetags_img" value="Merge" title="Add tags to or subtract tags from the selector list above.&#10;Tags preceeded with '-' (minus) will be removed." />
                         <!--input type="button" onClick="clearStagedTags(); return false;" class="cleartags_img" value="" title="Clear tags to be applied to next jot" /-->
  </div>
</form>

<div id="jotcontrols">
  <input type="button" id="toggleOrder" onClick="toggleOrdering(); return false;" title="Press to show oldest jots first."/>
  <input type="button" id="paginate_prev" onClick="paginator(0); return false;" title="Press to see previous ten jots."/>
  <input type="button" id="paginate_next" onClick="paginator(1); return false;" title="Press to see next ten jots."/>
  <p id="statusarea">Status</p>
  <!--input type="submit" value="New Jot Jar" title="Your jots can be organized by Jars, as well as tags."/-->
  <!--input type="submit" onClick = "removeAll(); return false;" value="Delete all jots" title="Be very careful. This will delete all your jots locally and remotely!" /-->
</div>

<!--ul id="jotItems">
</ul-->
<div id="jotItems">
  <!-- Each jot gets its own div inside the jotItems div. -->
</div>


</div>  <!-- end container div -->

<!-- This is the about / help dialog content, which shows only when user clicks the tools button:About link -->
<div id="dialog" class=WordSection1>

<h1 class="usage">About Thought Jot, and how to use it.</h1>
<p class="usage">Welcome to Thought Jot, an online way to keep notes that 
sync across devices and that you can use to see different views of your notes on
different devices.</p>

<p class="usage">Thought Jot has a simple interface that supports jots with
text, links, and images. Each jot can have a title and tags attached to it,
along with its content. You can filter restrict or filter the jots you see using jot titles,
tags, and creation dates.</p>

<h1 class="usage">First Things First - telling Thought Jot where to store your jots.</h1>
<p class="usage">Thought Jot stores your jots remotely, using either your Dropbox account or your Google Drive account. Of course, this can't be done without your permission. So before you can save your jots you need to tell the remote store you want to allow
Thought Jot to put things there. The only things Thought Jot will put there are the jots themselves, your current tags list, and
some book keeping data for the NimbusBase based transport layer that stores jots to and retrieves jots from the remote storage location.</p>

<h1 class="usage">Jotting</h1>

<p class="usage"><o:p>&nbsp;</o:p></p>

<h1 class="usage">Filtering</h1>

<p class="usage"><o:p>&nbsp;</o:p></p>

<h1 class="usage">Understanding where jots and filters are stored.</h1>

<p class="usage"><o:p>&nbsp;</o:p></p>

<h1 class="usage">How Thought Jot works</h1>

<p class="usage"><o:p>&nbsp;</o:p></p>

</div>
<!-- end of about / help content -->
</body>
</html>
